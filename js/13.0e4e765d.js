(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"2fd0":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-table",{attrs:{data:e.data,columns:e.columns,"row-key":"_id",loading:e.loading,filter:e.filter,pagination:e.pagination,"visible-columns":e.visibleColumns,"rows-per-page-options":[10]},scopedSlots:e._u([{key:"top",fn:function(t){return[a("span",{staticClass:"text-h5"},[e._v("Situation par wilaya")]),a("q-space"),a("q-btn",{staticClass:"col-auto q-mr-md",attrs:{color:"grey-3","text-color":"blue-grey",unelevated:"",icon:"print",label:"Situation"},on:{click:e.printSituation}}),a("q-btn",{staticClass:"col-auto",attrs:{color:"grey-3","text-color":"blue-grey",unelevated:"",icon:"refresh",label:"Actualiser"},on:{click:e.refresh}})]}},{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t}},[a("q-td",{key:"id",attrs:{props:t}},[e._v(e._s(t.rowIndex+1))]),a("q-td",{key:"code",attrs:{props:t}},[e._v(e._s(t.row.code))]),a("q-td",{key:"commune",attrs:{props:t}},[e._v(e._s(t.row.commune))]),a("q-td",{key:"total",attrs:{props:t}},[e._v(e._s(e.format(t.row.total))+"\n            ")]),a("q-td",{key:"renseignes",attrs:{props:t}},[e._v(e._s(t.row.renseignes))]),a("q-td",{key:"taux_renseigne",attrs:{props:t}},[e._v(e._s(t.row.taux_renseigne))]),a("q-td",{key:"valides",attrs:{props:t}},[e._v(e._s(e.format(t.row.valides)))]),a("q-td",{key:"taux_valide",attrs:{props:t}},[e._v(e._s(t.row.taux_valide))])],1),(t.rowIndex+1)%10==0||t.rowIndex==e.data.length-1?a("q-tr",{staticClass:"text-teal-8 text-bold",attrs:{props:t}},[a("q-td",{key:"id",attrs:{props:t}},[e._v("Total")]),a("q-td",{key:"code",attrs:{props:t}}),a("q-td",{key:"commune",attrs:{props:t}}),a("q-td",{key:"total",attrs:{props:t}},[e._v(e._s(e.format(e.totaux.total))+"\n            ")]),a("q-td",{key:"renseignes",attrs:{props:t}},[e._v(e._s(e.format(e.totaux.renseigne)))]),a("q-td",{key:"taux_renseigne",attrs:{props:t}},[e._v(e._s(e.totaux.taux_renseigne))]),a("q-td",{key:"valides",attrs:{props:t}},[e._v(e._s(e.format(e.totaux.valide)))]),a("q-td",{key:"taux_valide",attrs:{props:t}},[e._v(e._s(e.totaux.taux_valide))])],1):e._e()]}}])})],1)]),a("q-dialog",{model:{value:e.addDialog,callback:function(t){e.addDialog=t},expression:"addDialog"}},[a("messagerieAdd",{on:{close:e.itemAdded}})],1),a("q-dialog",{model:{value:e.updateDialog,callback:function(t){e.updateDialog=t},expression:"updateDialog"}},[a("messagerieUpdate",{on:{close:function(t){e.updateDialog=!1}}})],1),a("q-dialog",{model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[a("messagerieShow",{on:{close:function(t){e.showDialog=!1}}})],1)],1)},i=[],o=a("8baf"),n=(a("0da4"),a("bd4c")),l=a("a6c0"),r={name:"PagePage1",computed:{situations:{get:function(){return this.$store.getters["fiche/situations"]},set:function(e){this.$store.commit("fiche/set_situations",e)}},wilaya:function(){return this.$store.getters["fiche/wilaya"]},commune:function(){return this.$store.getters["fiche/commune"]},user:function(){return this.$store.getters["auth/user"]},messagerie_validation(){return"rga_validation"==this.db}},watch:{total_rows:function(e){this.pagination.rowsNumber=e},wilaya:function(e){this.refresh()},commune:function(e){this.refresh()}},data(){return{filter:"",loading:!1,totaux:null,pagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:10},addDialog:!1,updateDialog:!1,showDialog:!1,data:[],visibleColumns:["id","code","commune","total","renseignes","taux_renseigne","valides","taux_valide"],columns:[{name:"id",field:"id",label:"N°",align:"left",sortable:!1},{name:"code",field:"code",label:"Code wilaya",align:"left",sortable:!1},{name:"commune",field:"commune",label:"Wilaya",align:"left",sortable:!1},{name:"total",field:"total",label:"Total",align:"left",sortable:!1},{name:"renseignes",field:"renseignes",label:"Renseignés",align:"left",sortable:!1},{name:"taux_renseigne",field:"taux_renseigne",label:"Taux renseigné",align:"left",sortable:!1},{name:"valides",field:"valides",label:"Validés",align:"left",sortable:!1},{name:"taux_valide",field:"taux_valide",label:"Taux Validé",align:"left",sortable:!1}]}},components:{"select-wilaya":a("0b56").default,"select-commune":a("2112").default,messagerieAdd:a("9ca0").default,messagerieUpdate:a("9609").default,messagerieShow:a("18e4").default},methods:{editMessagerie(e){this.$store.dispatch("messagerie/setCurrentMessagerie",e),this.updateDialog=!0},showMessagerie(e){this.$store.dispatch("messagerie/setCurrentMessagerie",e),this.showDialog=!0},deleteMessagerie(e){this.$q.dialog({name:"Supprission",message:"Voulez vous supprimer ?",cancel:!0,persistent:!0}).onOk(()=>{this.$store.dispatch("messagerie/deleteMessagerie",e).then(()=>{this.refresh()})}).onCancel(()=>{console.log(">>>> Cancel")})},itemAdded(){this.addDialog=!1,this.$q.notify({message:"Message Envoyé avec succès !",type:"positive"}),this.refresh()},refresh(){this.onRequest({pagination:this.pagination})},onRequest(){this.$store.dispatch("fiche/getTotalSituationByMadr").then(e=>{this.$store.dispatch("fiche/getSituationMadrRenseigne").then(e=>{this.data=this.situations,this.totaux=e,this.$store.dispatch("fiche/getSituationMadrValide").then(e=>{for(let t=0;t<this.data.length;t++)this.data[t].valides=this.situations[t].valides,this.data[t].taux_valide=this.situations[t].taux_valide;this.totaux.valide=e.valide,this.totaux.taux_valide=e.taux_valide,this.loading=!1})})})},printSituation(){this.$store.dispatch("fiche/getSituationPrintMadr",this.data).then(e=>{const t=new o["jsPDF"]("p","mm");let a=Date.now(),s=n["a"].formatDate(a,"DD/MM/YYYY HH:mm");t.setFontSize(12).text("SITUATION ARRÊTÉE AU "+s,70,10),t.autoTable({head:[["N°","Wilayas","Total","Renseignés","Taux","Validés","Taux"]],body:e,foot:[[{content:"Total",colSpan:2,styles:{halign:"left"}},{content:this.totaux.total,styles:{halign:"center"}},{content:this.totaux.renseigne,styles:{halign:"center"}},{content:this.totaux.taux_renseigne,styles:{halign:"center"}},{content:this.totaux.valide,styles:{halign:"center"}},{content:this.totaux.taux_valide,styles:{halign:"center"}}]],theme:"grid",tableWidth:180,columnStyles:{1:{halign:"left"}},styles:{columnWidth:"auto",fillColor:[255,255,255],textColor:[0,0,0],lineColor:[0,0,0],lineWidth:.2,halign:"center"},headerStyles:{fillColor:[240,240,240]},margin:{top:20}}),window.open(t.output("bloburl"))})},saveTotal(e){let t={_id:e.code+"",code:e.code,commune:e.commune,wilaya:Number(this.wilaya.code),total:e.total};this.$store.dispatch("fiche/getTotalSituation",e.code).then(e=>{e&&(t._rev=e),this.$store.dispatch("fiche/setTotalSituation",t).then(e=>{this.refresh()})}).catch(e=>{this.$store.dispatch("fiche/setTotalSituation",t).then(e=>{this.refresh()})})},round(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)},format(e){return l["a"].format(e)}},mounted(){this.onRequest()}},d=r,u=a("2877"),c=a("9989"),h=a("eaac"),g=a("2c91"),p=a("9c40"),m=a("bd08"),f=a("db86"),v=a("24e8"),_=a("eebe"),x=a.n(_),b=Object(u["a"])(d,s,i,!1,null,null,null);t["default"]=b.exports;x()(b,"components",{QPage:c["a"],QTable:h["a"],QSpace:g["a"],QBtn:p["a"],QTr:m["a"],QTd:f["a"],QDialog:v["a"]})},d91c:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("desktop")],1)},i=[],o={components:{desktop:a("2fd0").default}},n=o,l=a("2877"),r=a("9989"),d=a("eebe"),u=a.n(d),c=Object(l["a"])(n,s,i,!1,null,null,null);t["default"]=c.exports;u()(c,"components",{QPage:r["a"]})}}]);