(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{"6642f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-table",{attrs:{data:t.data,columns:t.columns,"row-key":"_id",loading:t.loading,filter:t.filter,pagination:t.pagination,"visible-columns":t.visibleColumns,"rows-per-page-options":[10]},scopedSlots:t._u([{key:"top",fn:function(e){return[a("span",{staticClass:"text-h5"},[t._v("Situation par commune")]),"MADR"==t.user.typeCompte?a("select-wilaya"):t._e(),a("q-space"),a("btn-print",{staticClass:"col-auto q-mr-md"}),a("q-btn",{staticClass:"col-auto",attrs:{color:"grey-3","text-color":"blue-grey",unelevated:"",icon:"refresh",label:"Actualiser"},on:{click:t.refresh}})]}},{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-td",{key:"id",attrs:{props:e}},[t._v(t._s(e.rowIndex+1))]),a("q-td",{key:"code",attrs:{props:e}},[t._v(t._s(e.row.code))]),a("q-td",{key:"commune",attrs:{props:e}},[t._v(t._s(e.row.commune))]),a("q-td",{key:"total",attrs:{props:e}},[t._v(t._s(t.format(e.row.total))+"\n              "),"WILAYA"==t.user.typeCompte?a("q-popup-edit",{on:{save:function(a){return t.saveTotal(e.row)}},model:{value:e.row.total,callback:function(a){t.$set(e.row,"total",a)},expression:"props.row.total"}},[a("q-input",{attrs:{dense:"",autofocus:"",counter:"",type:"number"},model:{value:e.row.total,callback:function(a){t.$set(e.row,"total",t._n(a))},expression:"props.row.total"}})],1):t._e()],1),a("q-td",{key:"renseignes",attrs:{props:e}},[t._v(t._s(e.row.renseignes))]),a("q-td",{key:"valides",attrs:{props:e}},[t._v(t._s(t.format(e.row.valides)))]),a("q-td",{key:"taux",attrs:{props:e}},[t._v(t._s(e.row.taux))])],1),(e.rowIndex+1)%10==0||e.rowIndex==t.data.length-1?a("q-tr",{staticClass:"text-teal-8 text-bold",attrs:{props:e}},[a("q-td",{key:"id",attrs:{props:e}},[t._v("Total")]),a("q-td",{key:"code",attrs:{props:e}}),a("q-td",{key:"commune",attrs:{props:e}}),a("q-td",{key:"total",attrs:{props:e}},[t._v(t._s(t.format(t.totaux.total))+"\n              \n            ")]),a("q-td",{key:"renseignes",attrs:{props:e}},[t._v(t._s(t.format(t.totaux.renseigne)))]),a("q-td",{key:"valides",attrs:{props:e}},[t._v(t._s(t.format(t.totaux.valide)))]),a("q-td",{key:"taux",attrs:{props:e}},[t._v(t._s(t.totaux.taux))])],1):t._e()]}}])})],1)]),a("q-dialog",{model:{value:t.addDialog,callback:function(e){t.addDialog=e},expression:"addDialog"}},[a("messagerieAdd",{on:{close:t.itemAdded}})],1),a("q-dialog",{model:{value:t.updateDialog,callback:function(e){t.updateDialog=e},expression:"updateDialog"}},[a("messagerieUpdate",{on:{close:function(e){t.updateDialog=!1}}})],1),a("q-dialog",{model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[a("messagerieShow",{on:{close:function(e){t.showDialog=!1}}})],1)],1)},o=[],i=(a("0da4"),a("a6c0")),n={name:"PagePage1",computed:{situations:{get:function(){return this.$store.getters["fiche/situations"]},set:function(t){this.$store.commit("fiche/set_situations",t)}},data:{get:function(){return this.$store.getters["situation/data_to_print"]},set:function(t){this.$store.commit("situation/set_data_to_print",t)}},totaux:{get:function(){return this.$store.getters["situation/totaux"]},set:function(t){this.$store.commit("situation/set_totaux",t)}},wilaya:function(){return this.$store.getters["fiche/wilaya"]},commune:function(){return this.$store.getters["fiche/commune"]},user:function(){return this.$store.getters["auth/user"]},messagerie_validation(){return"rga_validation"==this.db}},watch:{total_rows:function(t){this.pagination.rowsNumber=t},wilaya:function(t){this.onRequest()},commune:function(t){this.refresh()}},data(){return{filter:"",loading:!1,pagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:10},addDialog:!1,updateDialog:!1,showDialog:!1,visibleColumns:["id","code","commune","total","renseignes","valides","taux"],columns:[{name:"id",field:"id",label:"id",align:"left",sortable:!1},{name:"code",field:"code",label:"Code",align:"left",sortable:!1},{name:"commune",field:"commune",label:"Commune",align:"left",sortable:!1},{name:"total",field:"total",label:"Total",align:"left",sortable:!1},{name:"renseignes",field:"renseignes",label:"Renseignés",align:"left",sortable:!1},{name:"valides",field:"valides",label:"Validés",align:"left",sortable:!1},{name:"taux",field:"taux",label:"Taux",align:"left",sortable:!1}]}},components:{"select-wilaya":a("0b56").default,"select-commune":a("2112").default,"btn-print":a("71be").default,messagerieAdd:a("9ca0").default,messagerieUpdate:a("9609").default,messagerieShow:a("18e4").default},methods:{editMessagerie(t){this.$store.dispatch("messagerie/setCurrentMessagerie",t),this.updateDialog=!0},showMessagerie(t){this.$store.dispatch("messagerie/setCurrentMessagerie",t),this.showDialog=!0},deleteMessagerie(t){this.$q.dialog({name:"Supprission",message:"Voulez vous supprimer ?",cancel:!0,persistent:!0}).onOk(()=>{this.$store.dispatch("messagerie/deleteMessagerie",t).then(()=>{this.refresh()})}).onCancel(()=>{console.log(">>>> Cancel")})},itemAdded(){this.addDialog=!1,this.$q.notify({message:"Message Envoyé avec succès !",type:"positive"}),this.refresh()},refresh(){this.onRequest()},onRequest(){this.loading=!0,this.wilaya&&this.wilaya.code?(console.log("wilaya detected"),this.$store.dispatch("fiche/set_communes_wilaya",this.wilaya.code).then(()=>{this.$store.dispatch("fiche/getTotalSituationByWilaya",this.wilaya.code).then(t=>{this.$store.dispatch("fiche/getSituationWilaya",this.wilaya.code).then(t=>{this.data=this.situations,this.loading=!1,this.totaux=t})})})):(this.data=[],this.loading=!1)},saveTotal(t){let e={_id:t.code+"",code:t.code,commune:t.commune,wilaya:Number(this.wilaya.code),total:t.total};this.$store.dispatch("fiche/getTotalSituation",t.code).then(t=>{t&&(e._rev=t),this.$store.dispatch("fiche/setTotalSituation",e).then(t=>{this.refresh()})}).catch(t=>{this.$store.dispatch("fiche/setTotalSituation",e).then(t=>{this.refresh()})})},round(t,e){return Number(Math.round(t+"e"+e)+"e-"+e)},format(t){return i["a"].format(t)}},created(){},mounted(){this.onRequest()}},l=n,r=a("2877"),u=a("9989"),c=a("eaac"),d=a("2c91"),h=a("9c40"),p=a("bd08"),g=a("db86"),m=a("42a1"),f=a("27f9"),b=a("24e8"),w=a("eebe"),y=a.n(w),_=Object(r["a"])(l,s,o,!1,null,null,null);e["default"]=_.exports;y()(_,"components",{QPage:u["a"],QTable:c["a"],QSpace:d["a"],QBtn:h["a"],QTr:p["a"],QTd:g["a"],QPopupEdit:m["a"],QInput:f["a"],QDialog:b["a"]})},"71be":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-btn",{attrs:{color:"grey-3","text-color":"blue-grey",unelevated:"",icon:"print",label:"Situation"},on:{click:t.printSituation}})},o=[],i=a("8baf"),n=a("bd4c"),l=(a("0da4"),{data(){return{}},computed:{data:function(){return this.$store.getters["situation/data_to_print"]},wilaya:function(){return this.$store.getters["fiche/wilaya"]},totaux:function(){return this.$store.getters["situation/totaux"]}},methods:{printSituation(){this.$store.dispatch("fiche/getSituationPrint",this.data).then(t=>{const e=new i["jsPDF"]("p","mm");let a=Date.now(),s=n["a"].formatDate(a,"DD/MM/YYYY HH:mm");e.setFontSize(12).text("SITUATION ARRÊTÉE AU: "+s,14,10),e.line(14,11,65,11),e.setFontSize(12).text("WILAYA: "+this.wilaya.name,14,17),e.line(14,18,30,18),e.autoTable({head:[["ID","Communes","Total","Renseignés","Validés","Taux"]],body:t,foot:[[{content:"Total wilaya",colSpan:2,styles:{halign:"left"}},{content:this.totaux.total,styles:{halign:"center"}},{content:this.totaux.renseigne,styles:{halign:"center"}},{content:this.totaux.valide,styles:{halign:"center"}},{content:this.totaux.taux,styles:{halign:"center"}}]],theme:"grid",tableWidth:180,startY:20,columnStyles:{1:{halign:"left"}},styles:{cellWidth:"auto",fillColor:[255,255,255],textColor:[0,0,0],lineColor:[0,0,0],lineWidth:.2,halign:"center"},headStyles:{fillColor:[240,240,240]},margin:{top:20}}),window.open(e.output("bloburl"))})}},mounted(){}}),r=l,u=a("2877"),c=a("9c40"),d=a("eebe"),h=a.n(d),p=Object(u["a"])(r,s,o,!1,null,null,null);e["default"]=p.exports;h()(p,"components",{QBtn:c["a"]})},b134:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("desktop")],1)},o=[],i={components:{desktop:a("6642f").default}},n=i,l=a("2877"),r=a("9989"),u=a("eebe"),c=a.n(u),d=Object(l["a"])(n,s,o,!1,null,null,null);e["default"]=d.exports;c()(d,"components",{QPage:r["a"]})}}]);